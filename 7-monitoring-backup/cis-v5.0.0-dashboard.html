<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CIS Microsoft 365 Foundations Benchmark v5.0.0</title>
<style>
  :root {
    --bg: #f5f7fb;
    --panel: #ffffff;
    --text: #0f172a;
    --subtext: #475569;
    --muted: #64748b;
    --border: #e2e8f0;
    --border-strong: #cbd5e1;
    --accent: #3b82f6;
    --accent-2: #06b6d4;
    --good: #16a34a;
    --warn: #d97706;
    --bad:  #dc2626;
    --chip-bg: #eff6ff;
    --chip-border: #dbeafe;
    --chip-text: #1e40af;
    --radius: 14px;
    --shadow: 0 10px 24px rgba(15, 23, 42, 0.06);
    --shadow-weak: 0 1px 2px rgba(15, 23, 42, 0.06);
  }
  * { box-sizing: border-box; }
  html, body {
    margin:0; padding:0; background: var(--bg);
    color: var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  }
  header.hero {
    position: sticky; top: 0; z-index: 40;
    background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
    border-bottom: 1px solid var(--border);
  }
  .wrap { max-width: 1280px; margin: 0 auto; padding: 16px 20px; }
  .title-row { display:flex; align-items:center; gap:14px; }
  .logo {
    width: 42px; height: 42px; border-radius: 10px;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    display:grid; place-items:center; box-shadow: var(--shadow);
    color:white;
  }
  .logo svg { width:24px; height:24px; }
  h1 { margin:0; font-size: clamp(20px, 3vw, 26px); font-weight: 750; letter-spacing: 0.2px; }
  .subtitle { color: var(--subtext); font-size: 12px; margin-top: 2px; }
  .toolbar {
    margin-top: 14px;
    display:grid; grid-template-columns: 1fr auto auto; gap:10px; align-items:center;
  }
  .stat {
    display:flex; align-items:center; gap:8px;
    background: var(--panel); border:1px solid var(--border);
    padding: 8px 12px; border-radius: 999px; box-shadow: var(--shadow-weak);
    color: var(--subtext);
  }
  .btn {
    cursor:pointer; font-weight:600;
    border-radius: 10px; padding:10px 14px;
    border:1px solid var(--border-strong);
    background: var(--panel); color: var(--text);
    transition: transform .05s ease-in-out, border-color .15s, box-shadow .15s, background .15s;
    box-shadow: var(--shadow-weak);
  }
  .btn:hover { border-color: var(--accent); }
  .btn:active { transform: translateY(1px); }
  .btn.primary { background: var(--accent); color: white; border-color: var(--accent); }
  .btn.primary:hover { filter: brightness(0.98); }

  .field, select, input[type="search"] {
    width:100%;
    border-radius: 10px;
    border: 1px solid var(--border-strong);
    padding: 12px 14px;
    background: #ffffff;
    color: var(--text);
    outline: none;
    box-shadow: var(--shadow-weak);
  }
  input::placeholder { color: #94a3b8; }

  select {
    appearance: none; -webkit-appearance: none; -moz-appearance: none;
    background-image:
      url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20' fill='none' stroke='%23566' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 8 10 12 14 8'/></svg>");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 20px 20px;
    padding-right: 40px;
  }
  select:focus, input[type="search"]:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(59,130,246,0.18);
  }

  main { max-width: 1280px; margin: 18px auto 60px; padding: 0 20px; }

  .card { background: var(--panel); border:1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); }
  .pad { padding: 14px; }

  .summary-row { display:flex; gap:10px; align-items:center; margin: 16px 0; }
  .summary-row label { min-width: 150px; color: var(--subtext); font-size: 13px; }

  .filters-grid { display: grid; gap: 12px; grid-template-columns: repeat(5, minmax(0, 1fr)); }
  .filter-group label { display:block; font-size: 12px; color: var(--subtext); margin-bottom: 6px; }
  .filter-group select { width:100%; }

  .table-wrap { margin-top: 14px; overflow: clip; border-top-left-radius: var(--radius); border-top-right-radius: var(--radius); }
  table { width:100%; border-collapse: collapse; }
  thead th {
    position: sticky; top: 0; z-index: 10;
    background: #f8fafc; color:#0f172a;
    border-bottom: 1px solid var(--border);
    text-align:left; font-weight:700; font-size: 13px; padding: 12px; cursor: pointer; user-select:none;
  }
  tbody td {
    font-size: 14px; padding: 12px; border-bottom: 1px solid var(--border);
    vertical-align: top; color: #111827;
  }
  tbody tr:nth-child(odd) { background: #fbfdff; }
  tbody tr:hover { background: #f1f5f9; }
  .sort-ind { font-size:11px; color:#334155; margin-left:6px; }
  .chips { display:flex; gap:6px; flex-wrap: wrap; }
  .chip { background: var(--chip-bg); color: var(--chip-text); border:1px solid var(--chip-border); padding: 3px 8px; border-radius: 999px; font-size: 12px; }

  .status.Open { color: var(--warn); font-weight:700; }
  .status.Compliant { color: var(--good); font-weight:700; }

  .pagination { display:flex; gap:8px; justify-content:flex-end; align-items:center; padding: 10px; border-top: 1px solid var(--border); }
  .pagination .btn { padding: 8px 12px; }
  .page-size { width:auto; }

  @media (max-width: 1100px) { .filters-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
</style>
</head>
<body>
<header class="hero">
  <div class="wrap">
    <div class="title-row">
      <div class="logo" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 3v18M3 12h18" stroke-linecap="round"/>
        </svg>
      </div>
      <div>
        <h1>CIS Microsoft 365 Foundations Benchmark v5.0.0</h1>
        <div class="subtitle">Generated 2025-10-24 18:48</div>
      </div>
    </div>
    <div class="toolbar">
      <div class="stat" title="Rows currently shown">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
        <span id="shownCount">0</span>/<span id="totalCount">130</span>
      </div>
      <button id="clear" class="btn" title="Clear all filters">Clear filters</button>
      <button id="exportCsv" class="btn primary" title="Export current view to CSV">Export CSV</button>
    </div>
  </div>
</header>

<main>
  <div class="card">
    <div class="pad">
      <div class="summary-row">
        <label for="summaryQ">Search in Summary</label>
        <input id="summaryQ" class="field" type="search" placeholder="Type keywords to filter the Summary column only">
      </div>
      <div class="filters-grid" id="filtersGrid"></div>
    </div>

    <div class="table-wrap">
      <table id="dataTable">
        <thead>
          <tr>
            <th data-col='Control'>Control <span class='sort-ind'></span></th>
            <th data-col='Profile'>Profile <span class='sort-ind'></span></th>
            <th data-col='Summary'>Summary <span class='sort-ind'></span></th>
            <th data-col='Category'>Category <span class='sort-ind'></span></th>
            <th data-col='Status'>Status <span class='sort-ind'></span></th>
            <th data-col='Implementation Group'>Implementation Group <span class='sort-ind'></span></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="pagination">
        <button id="prevPage" class="btn">Prev</button>
        <span id="pageInfo" class="subtitle">Page 1</span>
        <button id="nextPage" class="btn">Next</button>
        <select id="pageSize" class="field page-size" title="Rows per page">
          <option>10</option>
          <option selected>25</option>
          <option>50</option>
          <option>100</option>
        </select>
      </div>
    </div>
  </div>
</main>

<script>
const RAW = [{"Control":"5.2.3.6","Profile":"L1","Summary":"5.2.3.6 (L1) Ensure system-preferred multifactor authentication is enabled (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.2.1","Profile":"L1","Summary":"2.2.1 (L1) Ensure emergency access account activity is monitored (Manual)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.3.5","Profile":"L1","Summary":"5.3.5 (L1) Ensure approval is required for Privileged Role Administrator activation (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.2.2.12","Profile":"L1","Summary":"5.2.2.12 (L1) Ensure the device code sign-in flow is blocked (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"4.2","Profile":"L2","Summary":"4.2 (L2) Ensure device enrollment for personally owned devices is blocked by default (Manual)","Category":"4. Microsoft Intune Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"4.1","Profile":"L2","Summary":"4.1 (L2) Ensure devices without a compliance policy are marked 'not compliant' (Automated)","Category":"4. Microsoft Intune Admin Center","Status":"Open","Implementation Group":[]},{"Control":"9.1.11","Profile":"L1","Summary":"9.1.11 (L1) Ensure Service Principals cannot create and use profiles (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":[]},{"Control":"9.1.10","Profile":"L1","Summary":"9.1.10 (L1) Ensure access to APIs by Service Principals is restricted (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":[]},{"Control":"9.1.9","Profile":"L1","Summary":"9.1.9 (L1) Ensure 'Block ResourceKey Authentication' is 'Enabled' (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"9.1.8","Profile":"L1","Summary":"9.1.8 (L1) Ensure enabling of external data sharing is restricted (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"9.1.7","Profile":"L1","Summary":"9.1.7 (L1) Ensure shareable links are restricted (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"9.1.6","Profile":"L1","Summary":"9.1.6 (L1) Ensure 'Allow users to apply sensitivity labels for content' is 'Enabled' (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"9.1.5","Profile":"L2","Summary":"9.1.5 (L2) Ensure 'Interact with and share R and Python' visuals is 'Disabled' (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"9.1.4","Profile":"L1","Summary":"9.1.4 (L1) Ensure 'Publish to web' is restricted (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"9.1.3","Profile":"L1","Summary":"9.1.3 (L1) Ensure guest access to content is restricted (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"9.1.2","Profile":"L1","Summary":"9.1.2 (L1) Ensure external user invitations are restricted (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG3"]},{"Control":"9.1.1","Profile":"L1","Summary":"9.1.1 (L1) Ensure guest user access is restricted (Manual)","Category":"9. Microsoft Fabric","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"8.6.1","Profile":"L1","Summary":"8.6.1 (L1) Ensure users can report security concerns in Teams (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.5.9","Profile":"L2","Summary":"8.5.9 (L2) Ensure meeting recording is off by default (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"8.5.8","Profile":"L2","Summary":"8.5.8 (L2) Ensure external meeting chat is off (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"8.5.7","Profile":"L1","Summary":"8.5.7 (L1) Ensure external participants can't give or request control (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.5.6","Profile":"L2","Summary":"8.5.6 (L2) Ensure only organizers and co-organizers can present (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.5.5","Profile":"L2","Summary":"8.5.5 (L2) Ensure meeting chat does not allow anonymous users (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.5.4","Profile":"L1","Summary":"8.5.4 (L1) Ensure users dialing in can't bypass the lobby (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.5.3","Profile":"L1","Summary":"8.5.3 (L1) Ensure only people in my org can bypass the lobby (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":["IG3"]},{"Control":"8.5.2","Profile":"L1","Summary":"8.5.2 (L1) Ensure anonymous users and dial-in callers can't start a meeting (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.5.1","Profile":"L2","Summary":"8.5.1 (L2) Ensure anonymous users can't join a meeting (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.4.1","Profile":"L1","Summary":"8.4.1 (L1) Ensure app permission policies are configured (Manual)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"8.2.4","Profile":"L1","Summary":"8.2.4 (L1) Ensure communication with Skype users is disabled (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"8.2.3","Profile":"L1","Summary":"8.2.3 (L1) Ensure external Teams users cannot initiate conversations (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.2.2","Profile":"L1","Summary":"8.2.2 (L1) Ensure communication with unmanaged Teams users is disabled (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.2.1","Profile":"L2","Summary":"8.2.1 (L2) Ensure external domains are restricted in the Teams admin center (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.1.2","Profile":"L1","Summary":"8.1.2 (L1) Ensure users can't send emails to a channel email address (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":[]},{"Control":"8.1.1","Profile":"L2","Summary":"8.1.1 (L2) Ensure external file sharing in Teams is enabled for only approved cloud storage services (Automated)","Category":"8. Microsoft Teams Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"7.3.4","Profile":"L1","Summary":"7.3.4 (L1) Ensure custom script execution is restricted on site collections (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG3"]},{"Control":"7.3.3","Profile":"L1","Summary":"7.3.3 (L1) Ensure custom script execution is restricted on personal sites (Manual)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG3"]},{"Control":"7.3.2","Profile":"L2","Summary":"7.3.2 (L2) Ensure OneDrive sync is restricted for unmanaged devices (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":[]},{"Control":"7.3.1","Profile":"L2","Summary":"7.3.1 (L2) Ensure Office 365 SharePoint infected files are disallowed for download (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"7.2.11","Profile":"L1","Summary":"7.2.11 (L1) Ensure the SharePoint default sharing link permission is set (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":[]},{"Control":"7.2.10","Profile":"L1","Summary":"7.2.10 (L1) Ensure reauthentication with verification code is restricted (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":[]},{"Control":"7.2.9","Profile":"L1","Summary":"7.2.9 (L1) Ensure guest access to a site or OneDrive will expire automatically (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":[]},{"Control":"7.2.8","Profile":"L2","Summary":"7.2.8 (L2) Ensure external sharing is restricted by security group (Manual)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG3"]},{"Control":"7.2.7","Profile":"L1","Summary":"7.2.7 (L1) Ensure link sharing is restricted in SharePoint and OneDrive (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"7.2.6","Profile":"L2","Summary":"7.2.6 (L2) Ensure SharePoint external sharing is managed through domain whitelist/blacklists (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"7.2.5","Profile":"L2","Summary":"7.2.5 (L2) Ensure that SharePoint guest users cannot share items they don't own (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"7.2.4","Profile":"L2","Summary":"7.2.4 (L2) Ensure OneDrive content sharing is restricted (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"7.2.3","Profile":"L1","Summary":"7.2.3 (L1) Ensure external content sharing is restricted (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"7.2.2","Profile":"L1","Summary":"7.2.2 (L1) Ensure SharePoint and OneDrive integration with Azure AD B2B is enabled (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":[]},{"Control":"7.2.1","Profile":"L1","Summary":"7.2.1 (L1) Ensure modern authentication for SharePoint applications is required (Automated)","Category":"7. SharePoint Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"6.5.4","Profile":"L1","Summary":"6.5.4 (L1) Ensure SMTP AUTH is disabled (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"6.5.3","Profile":"L2","Summary":"6.5.3 (L2) Ensure additional storage providers are restricted in Outlook on the web (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"6.5.2","Profile":"L1","Summary":"6.5.2 (L1) Ensure MailTips are enabled for end users (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":[]},{"Control":"6.5.1","Profile":"L1","Summary":"6.5.1 (L1) Ensure modern authentication for Exchange Online is enabled (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"6.3.1","Profile":"L2","Summary":"6.3.1 (L2) Ensure users installing Outlook add-ins is not allowed (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"6.2.3","Profile":"L1","Summary":"6.2.3 (L1) Ensure email from external senders is identified (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":[]},{"Control":"6.2.2","Profile":"L1","Summary":"6.2.2 (L1) Ensure mail transport rules do not whitelist specific domains (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":["IG3"]},{"Control":"6.2.1","Profile":"L1","Summary":"6.2.1 (L1) Ensure all forms of mail forwarding are blocked and/or disabled (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":[]},{"Control":"6.1.3","Profile":"L1","Summary":"6.1.3 (L1) Ensure 'AuditBypassEnabled' is not enabled on mailboxes (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"6.1.2","Profile":"L1","Summary":"6.1.2 (L1) Ensure mailbox audit actions are configured (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"6.1.1","Profile":"L1","Summary":"6.1.1 (L1) Ensure 'AuditDisabled' organizationally is set to 'False' (Automated)","Category":"6. Exchange Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.3.4","Profile":"L1","Summary":"5.3.4 (L1) Ensure approval is required for Global Administrator role activation (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.3.3","Profile":"L1","Summary":"5.3.3 (L1) Ensure 'Access reviews' for privileged roles are configured (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.3.2","Profile":"L1","Summary":"5.3.2 (L1) Ensure 'Access reviews' for Guest Users are configured (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.3.1","Profile":"L2","Summary":"5.3.1 (L2) Ensure 'Privileged Identity Management' is used to manage roles (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.2.4.1","Profile":"L1","Summary":"5.2.4.1 (L1) Ensure 'Self service password reset enabled' is set to 'All' (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":[]},{"Control":"5.2.3.5","Profile":"L1","Summary":"5.2.3.5 (L1) Ensure weak authentication methods are disabled (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.3.4","Profile":"L1","Summary":"5.2.3.4 (L1) Ensure all member users are 'MFA capable' (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.3.3","Profile":"L1","Summary":"5.2.3.3 (L1) Ensure password protection is enabled for on-prem Active Directory (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.2.3.2","Profile":"L1","Summary":"5.2.3.2 (L1) Ensure custom banned passwords lists are used (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.2.3.1","Profile":"L1","Summary":"5.2.3.1 (L1) Ensure Microsoft Authenticator is configured to protect against MFA fatigue (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.2.2.11","Profile":"L1","Summary":"5.2.2.11 (L1) Ensure sign-in frequency for Intune Enrollment is set to 'Every time' (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.2.10","Profile":"L1","Summary":"5.2.2.10 (L1) Ensure a managed device is required to register security information (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.2.9","Profile":"L2","Summary":"5.2.2.9 (L2) Ensure a managed device is required for authentication (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.2.8","Profile":"L2","Summary":"5.2.2.8 (L2) Ensure 'sign-in risk' is blocked for medium and high risk (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.2.7","Profile":"L1","Summary":"5.2.2.7 (L1) Enable Identity Protection sign-in risk policies (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.2.6","Profile":"L1","Summary":"5.2.2.6 (L1) Enable Identity Protection user risk policies (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.2.5","Profile":"L2","Summary":"5.2.2.5 (L2) Ensure 'Phishing-resistant MFA strength' is required for Administrators (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.2.2.4","Profile":"L1","Summary":"5.2.2.4 (L1) Ensure Sign-in frequency is enabled and browser sessions are not persistent for Administrative users (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.2.2.3","Profile":"L1","Summary":"5.2.2.3 (L1) Enable Conditional Access policies to block legacy authentication (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.2.2.2","Profile":"L1","Summary":"5.2.2.2 (L1) Ensure multifactor authentication is enabled for all users (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2"]},{"Control":"5.2.2.1","Profile":"L1","Summary":"5.2.2.1 (L1) Ensure multifactor authentication is enabled for all users in administrative roles (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.1.8.1","Profile":"L1","Summary":"5.1.8.1 (L1) Ensure that password hash sync is enabled for hybrid deployments (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.1.6.3","Profile":"L2","Summary":"5.1.6.3 (L2) Ensure guest user invitations are limited to the Guest Inviter role (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.1.6.2","Profile":"L1","Summary":"5.1.6.2 (L1) Ensure that guest user access is restricted (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.1.6.1","Profile":"L2","Summary":"5.1.6.1 (L2) Ensure that collaboration invitations are sent to allowed domains only (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.1.5.2","Profile":"L1","Summary":"5.1.5.2 (L1) Ensure the admin consent workflow is enabled (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.1.5.1","Profile":"L2","Summary":"5.1.5.1 (L2) Ensure user consent to apps accessing company data on their behalf is not allowed (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.1.3.1","Profile":"L1","Summary":"5.1.3.1 (L1) Ensure a dynamic group for guest users is created (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"5.1.2.6","Profile":"L2","Summary":"5.1.2.6 (L2) Ensure 'LinkedIn account connections' is disabled (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.1.2.5","Profile":"L2","Summary":"5.1.2.5 (L2) Ensure the option to remain signed in is hidden (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.1.2.4","Profile":"L1","Summary":"5.1.2.4 (L1) Ensure access to the Entra admin center is restricted (Manual)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":[]},{"Control":"5.1.2.3","Profile":"L1","Summary":"5.1.2.3 (L1) Ensure 'Restrict non-admin users from creating tenants' is set to 'Yes' (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":[]},{"Control":"5.1.2.2","Profile":"L2","Summary":"5.1.2.2 (L2) Ensure third party integrated applications are not allowed (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"5.1.2.1","Profile":"L1","Summary":"5.1.2.1 (L1) Ensure 'Per-user MFA' is disabled (Automated)","Category":"5. Microsoft Entra Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"3.3.1","Profile":"L1","Summary":"3.3.1 (L1) Ensure SharePoint Online Information Protection policies are set up and used (Manual)","Category":"3. Microsoft Purview","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"3.2.2","Profile":"L1","Summary":"3.2.2 (L1) Ensure DLP policies are enabled for Microsoft Teams (Automated)","Category":"3. Microsoft Purview","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"3.2.1","Profile":"L1","Summary":"3.2.1 (L1) Ensure DLP policies are enabled (Manual)","Category":"3. Microsoft Purview","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"3.1.1","Profile":"L1","Summary":"3.1.1 (L1) Ensure Microsoft 365 audit log search is Enabled (Automated)","Category":"3. Microsoft Purview","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"2.4.4","Profile":"L1","Summary":"2.4.4 (L1) Ensure Zero-hour auto purge for Microsoft Teams is on (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"2.4.3","Profile":"L2","Summary":"2.4.3 (L2) Ensure Microsoft Defender for Cloud Apps is enabled and configured (Manual)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"2.4.2","Profile":"L1","Summary":"2.4.2 (L1) Ensure Priority accounts have 'Strict protection' presets applied (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.4.1","Profile":"L1","Summary":"2.4.1 (L1) Ensure Priority account protection is enabled and configured (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG3"]},{"Control":"2.1.14","Profile":"L1","Summary":"2.1.14 (L1) Ensure inbound anti-spam policies do not contain allowed domains (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG3"]},{"Control":"2.1.13","Profile":"L1","Summary":"2.1.13 (L1) Ensure the connection filter safe list is off (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG3"]},{"Control":"2.1.12","Profile":"L1","Summary":"2.1.12 (L1) Ensure the connection filter IP allow list is not used (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG3"]},{"Control":"2.1.11","Profile":"L2","Summary":"2.1.11 (L2) Ensure comprehensive attachment filtering is applied (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.1.10","Profile":"L1","Summary":"2.1.10 (L1) Ensure DMARC Records for all Exchange Online domains are published (Manual)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.1.9","Profile":"L1","Summary":"2.1.9 (L1) Ensure that DKIM is enabled for all Exchange Online Domains (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.1.8","Profile":"L1","Summary":"2.1.8 (L1) Ensure that SPF records are published for all Exchange Domains (Manual)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.1.7","Profile":"L2","Summary":"2.1.7 (L2) Ensure that an anti-phishing policy has been created (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG3"]},{"Control":"2.1.6","Profile":"L1","Summary":"2.1.6 (L1) Ensure Exchange Online Spam Policies are set to notify administrators (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.1.5","Profile":"L2","Summary":"2.1.5 (L2) Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"2.1.4","Profile":"L2","Summary":"2.1.4 (L2) Ensure Safe Attachments policy is enabled (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG3"]},{"Control":"2.1.3","Profile":"L1","Summary":"2.1.3 (L1) Ensure notifications for internal users sending malware is Enabled (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.1.2","Profile":"L1","Summary":"2.1.2 (L1) Ensure the Common Attachment Types Filter is enabled (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"2.1.1","Profile":"L2","Summary":"2.1.1 (L2) Ensure Safe Links for Office Applications is Enabled (Automated)","Category":"2. Microsoft 365 Defender","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.3.8","Profile":"L2","Summary":"1.3.8 (L2) Ensure that Sways cannot be shared with people outside of your organization (Manual)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"1.3.7","Profile":"L2","Summary":"1.3.7 (L2) Ensure 'third-party storage services' are restricted in 'Microsoft 365 on the web' (Manual)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.3.6","Profile":"L2","Summary":"1.3.6 (L2) Ensure the customer lockbox feature is enabled (Automated)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":[]},{"Control":"1.3.5","Profile":"L1","Summary":"1.3.5 (L1) Ensure internal phishing protection for Forms is enabled (Manual)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.3.4","Profile":"L1","Summary":"1.3.4 (L1) Ensure 'User owned apps and services' is restricted (Manual)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"1.3.3","Profile":"L2","Summary":"1.3.3 (L2) Ensure 'External sharing' of calendars is not available (Automated)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG2","IG3"]},{"Control":"1.3.2","Profile":"L1","Summary":"1.3.2 (L1) Ensure 'Idle session timeout' is set to '3 hours (or less)' for unmanaged devices (Manual)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.3.1","Profile":"L1","Summary":"1.3.1 (L1) Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)' (Automated)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.2.2","Profile":"L1","Summary":"1.2.2 (L1) Ensure sign-in to shared mailboxes is blocked (Automated)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":[]},{"Control":"1.2.1","Profile":"L2","Summary":"1.2.1 (L2) Ensure that only organizationally managed/approved public groups exist (Automated)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.1.4","Profile":"L1","Summary":"1.1.4 (L1) Ensure administrative accounts use licenses with a reduced application footprint (Automated)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.1.3","Profile":"L1","Summary":"1.1.3 (L1) Ensure that between two and four global admins are designated (Automated)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.1.2","Profile":"L1","Summary":"1.1.2 (L1) Ensure two emergency access accounts have been defined (Manual)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]},{"Control":"1.1.1","Profile":"L1","Summary":"1.1.1 (L1) Ensure Administrative accounts are cloud-only (Automated)","Category":"1. Microsoft 365 Admin Center","Status":"Open","Implementation Group":["IG1","IG2","IG3"]}];
const COLUMNS = ["Control","Profile","Summary","Category","Status","Implementation Group"];

function uniqueValues(field) {
  const set = new Set();
  for (const r of RAW) {
    const v = r[field];
    if (Array.isArray(v)) {
      for (const a of v) set.add(a);
    } else if (v !== undefined && v !== null) {
      set.add(v);
    }
  }
  return Array.from(set).sort((a,b)=>a.toString().localeCompare(b.toString(), undefined, {numeric:true}));
}

const DROPDOWN_COLS = ["Control","Profile","Category","Status","Implementation Group"];
const FILTERS = Object.fromEntries(DROPDOWN_COLS.map(c => [c, null])); // null = All

function renderFilters() {
  const grid = document.getElementById("filtersGrid");
  grid.innerHTML = "";
  for (const col of DROPDOWN_COLS) {
    const div = document.createElement("div");
    div.className = "filter-group";
    const label = document.createElement("label");
    label.textContent = col;
    const sel = document.createElement("select");
    sel.className = "field";
    const values = uniqueValues(col);
    sel.appendChild(Object.assign(document.createElement("option"), {value: "", textContent: "All"}));
    for (const v of values) {
      const o = document.createElement("option");
      o.value = v; o.textContent = v;
      if (FILTERS[col] === v) o.selected = true;
      sel.appendChild(o);
    }
    sel.addEventListener("change", () => { FILTERS[col] = sel.value || null; update(); });
    div.appendChild(label);
    div.appendChild(sel);
    grid.appendChild(div);
  }
}

let sortOrder = [["Control", 1]]; // Default sort by Control asc
function compareRows(a, b) {
  for (const [col, dir] of sortOrder) {
    const sa = Array.isArray(a[col]) ? a[col].join(", ") : (a[col] ?? "");
    const sb = Array.isArray(b[col]) ? b[col].join(", ") : (b[col] ?? "");
    const cmp = sa.toString().localeCompare(sb.toString(), undefined, {numeric:true, sensitivity:"base"});
    if (cmp !== 0) return cmp * dir;
  }
  return 0;
}

let currentPage = 1;
let pageSize = 25;

function applyFilters() {
  const q = document.getElementById("summaryQ").value.trim().toLowerCase();
  return RAW.filter(row => {
    const sum = (row["Summary"] ?? "").toString().toLowerCase();
    if (q && !sum.includes(q)) return false;

    for (const col of DROPDOWN_COLS) {
      const sel = FILTERS[col];
      if (sel === null) continue;
      const val = row[col];
      if (col === "Implementation Group") {
        const arr = Array.isArray(val) ? val : (val ? [val] : []);
        if (!arr.includes(sel)) return false;
      } else {
        if (val !== sel) return false;
      }
    }
    return true;
  });
}

function renderTable(rows) {
  const tbody = document.querySelector("#dataTable tbody");
  tbody.innerHTML = "";
  const start = (currentPage - 1) * pageSize;
  const end = Math.min(start + pageSize, rows.length);
  for (let i = start; i < end; i++) {
    const r = rows[i];
    const tr = document.createElement("tr");
    for (const col of COLUMNS) {
      const td = document.createElement("td");
      const v = r[col];
      if (Array.isArray(v)) {
        const wrap = document.createElement("div");
        wrap.className = "chips";
        v.forEach(ch => { const s = document.createElement("span"); s.className="chip"; s.textContent = ch; wrap.appendChild(s); });
        td.appendChild(wrap);
      } else {
        if (col === "Status") {
          const span = document.createElement("span");
          span.className = 'status ' + ((v ?? '').toString());
          span.textContent = v ?? "";
          td.appendChild(span);
        } else {
          td.textContent = (v ?? "").toString();
        }
      }
      tr.appendChild(td);
    }
    tbody.appendChild(tr);
  }
  document.getElementById("shownCount").textContent = rows.length;
  const totalPages = Math.max(1, Math.ceil(rows.length / pageSize));
  currentPage = Math.min(currentPage, totalPages);
  document.getElementById("pageInfo").textContent = "Page " + currentPage + " / " + totalPages;
  document.getElementById("prevPage").disabled = currentPage <= 1;
  document.getElementById("nextPage").disabled = currentPage >= totalPages;
}

function update() {
  let rows = applyFilters();
  rows.sort(compareRows);
  renderTable(rows);
}

function resetFilters() {
  document.getElementById("summaryQ").value = "";
  for (const col of DROPDOWN_COLS) FILTERS[col] = null;
  currentPage = 1;
  renderFilters();
  update();
}

function initSorting() {
  const headers = document.querySelectorAll("thead th");
  headers.forEach(th => {
    th.addEventListener("click", (e) => {
      const col = th.dataset.col;
      const withShift = e.shiftKey;
      const idx = sortOrder.findIndex(s => s[0] === col);
      if (!withShift) sortOrder = [];
      if (idx === -1) sortOrder.push([col, 1]);
      else {
        const d = sortOrder[idx][1];
        if (d === 1) sortOrder[idx][1] = -1; else sortOrder.splice(idx, 1);
      }
      document.querySelectorAll(".sort-ind").forEach(s => s.textContent = "");
      sortOrder.forEach(([c, d]) => {
        const h = document.querySelector('thead th[data-col="' + c + '"] .sort-ind');
        if (h) h.textContent = d === 1 ? "▲" : "▼";
      });
      update();
    });
  });
}

function exportCSV() {
  let rows = applyFilters().sort(compareRows);
  const header = COLUMNS.join(",");
  const csvRows = rows.map(r => COLUMNS.map(c => {
    let v = r[c];
    if (Array.isArray(v)) v = v.join("; ");
    v = (v ?? "").toString().replaceAll('"','""');
    if (/[",\n]/.test(v)) v = '"' + v + '"';
    return v;
  }).join(","));
  const csv = [header, ...csvRows].join("\n");
  const blob = new Blob([csv], {type: "text/csv;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "cis-view-clean.csv";
  a.click();
  URL.revokeObjectURL(url);
}

document.addEventListener("DOMContentLoaded", () => {
  renderFilters();
  initSorting();
  const ctrlHead = document.querySelector('thead th[data-col="Control"] .sort-ind');
  if (ctrlHead) ctrlHead.textContent = "";
  update();

  document.getElementById("summaryQ").addEventListener("input", () => { currentPage = 1; update(); });
  document.getElementById("clear").addEventListener("click", resetFilters);
  document.getElementById("prevPage").addEventListener("click", () => { if (currentPage>1) { currentPage--; update(); } });
  document.getElementById("nextPage").addEventListener("click", () => { currentPage++; update(); });
  document.getElementById("pageSize").addEventListener("change", (e) => { pageSize = parseInt(e.target.value,10); currentPage = 1; update(); });
  document.getElementById("exportCsv").addEventListener("click", exportCSV);
});
</script>
</body>
</html>
